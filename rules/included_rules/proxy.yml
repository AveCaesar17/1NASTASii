- proxy: 
    name: proxy_pass
    protocol: tls
    source: 
      ip: any 
      port: any 
    destination:
      ip: $EXTERNAL_NET
      port: 8889
    endpoint: 
      upstream:
        - id: back
          ssl: true
          hosts: 
            - server2
          service: http
          options:
            - keepalive: 8
        - id: back2
          ssl: false
          hosts: 
            - server1
          service: http
          options: 
            - keepalive: 8
            - hash: $remote_addr
      hostname: avecaesar.ru
      url: 
        - path: /back
          upstream_group: back
        - path: /back2
          upstream_group: back2
          options: 
            - proxy_set_header:        Host $host
            - proxy_set_header: X-Real-IP $remote_addr
            - proxy_set_header: X-Forwarded-For $remote_addr
            
            - proxy_intercept_errors: "on"
      ssl: 
        ssl_certificate: resources/ssl/cert.crt
        ssl_certificate_key: resources/ssl/cert.key
      optional:
        log_format:
          name: custom_log
          format: | 
            '$remote_addr - $remote_user [$time_local] "$request" '
                    '$status $body_bytes_sent "$http_referer" '
                    '"$http_user_agent" "$http_x_forwarded_for"';
      settings: 
        mds: 
          file: 
            - resources/mds/file1
